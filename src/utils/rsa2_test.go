package utils

import (
	"testing"
	"fmt"
)

func TestRsaSignWithSha1Hex2(t *testing.T) {
	priv_key := "30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100c7dce8900f6a00f06a631f95f3e2687ce85dbf042663697ef6f98e281e8e6a5f1e041d10be3a9832d70faf42402a749bc7233a0b4b50bda66024623ece59e653aa17c1ba5c4c0d777746135bef7b2fd68d1ce1f9b1ddc7a4efb8f648a15f2872f9e248eaf930c376c79db7e6a3270b541779239dafa04b0f28d0b2ea9a5cb6a70203010001028181008fe95b7450050e440ef6ed0976a13287ae71c25764a4f493bd96986bff04a147783f92063a53cabfe0e7a454da0b3807eb6e4c1f51ce03a1475d2b78f9f0f5cd46c72475748cb4200080cb1bd89734aaf610d764bb09de4e0d0339b8f8fafdc60fa45f2d7a6757d9adb1a6cac4753d0f855d45d34f7364ad7630d103dd2758c1024100e53e6f5d9f150a5bcf4af826f96b1ce7e57222e00708d7b95bfd383e06feac3297156cef14f6060fecb0a29e473569bc8b9dbc4c1119f251a18a9708513c6bb1024100df3099ef53200758b18903290cbe71c4e120dc202cc11e455478ecf19f824f9106456ad7f00d1d80dd511264f3cc0a17bbdfaecb3a2bec904a8383128044d5d7024100b9e5c4777e1e98d4d4a7adce252a883940e62a83d31087a74782734e516bca0608609682d6539f9ce04a68c4c367fc03aa9051f6b9537a1e5a4a41a9bbfeac3102406bf83eff9fdee6aee973b6abad1694430205bb77752f174dc2c79d186669cbc4049ca04b463d92003d10732d932329dec16c3c4ae4214b97a1f46cfc0e413e9102407d8f6e2262fc05ffe63fe7a0957d4a30b6be0b3d4c1842e7d9a51e86f8a4c1ced7999756aa4ff107f9680ee673ca42a23af9a40689de2c5da737332cbbb17c3d"
	sigdata := "user_login,157"
	sig_res, err := RsaSignWithSha1Hex(sigdata, priv_key)
	if err != nil {

		fmt.Println(err)
	}

	fmt.Println(sig_res)
}

func TestRsaSignWithSha1Hex3(t *testing.T) {
	priv_key := "30820276020100300d06092a864886f70d0101010500048202603082025c02010002818100f2848cdd17c3a032df890518efae09f37af44a26720c05808da995f491a2c4cf5b1153f2bca696ebcf91771a370b3d7b0b5d2b8fc15985806a1980a7dd3b77cb58f5bbafe23331139e30ecc7fdf12b83eee759de6da0e1d97e99a15e149a391cb74c1170f9a9046c4212e7b32da233b0b8eb5113ed68363c7c5bec3c80e169d9020301000102818074028037cb04637fb27aa31b989bd25acc784b78349a178fb534686d43b56f1c19de22203daa1b0bd691293e3b127f687ab928fb6d6c5b76604aaec69e07b2777f3c50d8a4aaa95cb2126c4cf9adc85c7c17dee6b8ef5b030a93755a7aa3e353bbe567c6762f6095468d9b72829d5f80c1010f4f5e22d1f9fe5e7d052dea6999024100fda4f1455f6dfedd0a454dda288302e452503a68f2b8f7065fd30ecf20da064b804155589b5ee690147da21e9e32ea7ae8359057a6cdd54c7be9b7f704198cab024100f4c52755f82f51cdd4a6781d0858b2cddc0517baa9a58fd65b75d864b7e45745d478786ae496332f19f1f4543675d9b23193356c176b4b186755063c27841b8b024071e4c2c217dbd87980c725f23406c021ae248055e7c7ce847a3ad7878284e416bafc9b4a325a26c5c3adb642715f039334f9f85aa37801b35a60d44e82f4c609024038a38a67a54765d988348124ceb29fa56d1d2c918002149798905b636afe0687dd138761ccc548d0c4632d93730ab03640ac7cb72770276f5d31da807ef05de30241008cf083fe5832f106862e8a06c0f80835b2022d0ed3899abd98614c119615399dbb162ebe258af0a57a9524f4aa800284f9fb3c760380f028ae9fa40bd7809de7"
	sigdata := "user_login,176"
	sig_res, err := RsaSignWithSha1Hex(sigdata, priv_key)
	if err != nil {

		fmt.Println(err)
	}

	fmt.Println(sig_res)
}

func TestRsaChangeNotifyStateWithSha1Hex2(t *testing.T) {
	priv_key := "30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100ece10d27f9eaecbdd5268e865715521c12634c7a1fe70fd4128147f3a5cfc86fd50660266daba2affb760d815cc132a2cafb904bde1c909e12cfa89eaf841abcce1936524c783ce5c6cd8b8b60b47050e14d17a9232e061b21d7b60746780e5bb7142b437ad1867e439deebfb6eea55892d98d95e29c8e2cbfe96a8141962665020301000102818100c3ce000f0471e1c1c558bac56764935beb0333eb5b45a77ad8d50ec1e3550f4d09dcdc4bc7a9f1afe07fa40843c0db775fac7489920f30a7c9cae78a4c71399b32e5c3405bef3ba8ecc09f39ee9444b488ab46bd1db6d35f66b53033d067934a3aa9afe4fe820f7e2877dc570b12139bf67b7ae130012d2166b0d0162cfa0081024100f9da26c8b25c8f508da7fa4961bfe917a9b5f296352f75cb10b52149f5ee4366ba93284a4f62797d748ba968da0bfdff575d3993d8b4888d5e476d2d001134a1024100f2b52e5de3a8c81dccf4cc9f76e9e3b92e1082b0e3e42e26c8a09cfc55151adf5f258440cb2fed1bea4461cd53b5c57e347d5b4be1a9513bf4a0562f45e89745024049cfc1bf6eb9db78dfb06d477a8238794e20bb5ed6ad83ae0eec83be16d261c51a7f58dac323036325a810cf320372f1193d28425e35cf557c31bbb61c9bf8a1024100d31b5cd535ac1d442e7dcf6df4d4c3cad29271dac29e3ab66953aab8a098d6e2ebb38a31818a9246f1a1c120036bdbf84657b30d719f009591d5d4a111c199b1024010dd12bb1707813c3384d18195f346e73640511aa9930945ec49f596a3b5523b913eaff3b87f9b1999a880b777912ebd82fa726cda07e316c4d2a9637b22a8cc"
	sessionId := "f7a9fab7-7dbe-4ba6-87b6-d04a70f55c74"
	operateId := "53"
	sigdata := "change_state," + sessionId + "," + operateId + "," + "[2]" + ",1"
	sig_res, err := RsaSignWithSha1Hex(sigdata, priv_key)
	if err != nil {

		fmt.Println(err)
	}

	fmt.Println(sig_res)
}

func TestRsaTransferWithSha1Hex2(t *testing.T) {
	priv_key := "30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100c7dce8900f6a00f06a631f95f3e2687ce85dbf042663697ef6f98e281e8e6a5f1e041d10be3a9832d70faf42402a749bc7233a0b4b50bda66024623ece59e653aa17c1ba5c4c0d777746135bef7b2fd68d1ce1f9b1ddc7a4efb8f648a15f2872f9e248eaf930c376c79db7e6a3270b541779239dafa04b0f28d0b2ea9a5cb6a70203010001028181008fe95b7450050e440ef6ed0976a13287ae71c25764a4f493bd96986bff04a147783f92063a53cabfe0e7a454da0b3807eb6e4c1f51ce03a1475d2b78f9f0f5cd46c72475748cb4200080cb1bd89734aaf610d764bb09de4e0d0339b8f8fafdc60fa45f2d7a6757d9adb1a6cac4753d0f855d45d34f7364ad7630d103dd2758c1024100e53e6f5d9f150a5bcf4af826f96b1ce7e57222e00708d7b95bfd383e06feac3297156cef14f6060fecb0a29e473569bc8b9dbc4c1119f251a18a9708513c6bb1024100df3099ef53200758b18903290cbe71c4e120dc202cc11e455478ecf19f824f9106456ad7f00d1d80dd511264f3cc0a17bbdfaecb3a2bec904a8383128044d5d7024100b9e5c4777e1e98d4d4a7adce252a883940e62a83d31087a74782734e516bca0608609682d6539f9ce04a68c4c367fc03aa9051f6b9537a1e5a4a41a9bbfeac3102406bf83eff9fdee6aee973b6abad1694430205bb77752f174dc2c79d186669cbc4049ca04b463d92003d10732d932329dec16c3c4ae4214b97a1f46cfc0e413e9102407d8f6e2262fc05ffe63fe7a0957d4a30b6be0b3d4c1842e7d9a51e86f8a4c1ced7999756aa4ff107f9680ee673ca42a23af9a40689de2c5da737332cbbb17c3d"
	sessionId := "cb865261-a990-4f43-8cec-aba0a01eeb92"
	operateId := "158"
	sigdata := "transfer," + sessionId + "," + operateId + ",1,3ACW2eaZcaTSrcmuCBjJsQtQnBvXAF8uKT,1.01,0.001,,"

	fmt.Println("sigdata:", sigdata)
	sig_res, err := RsaSignWithSha1Hex(sigdata, priv_key)
	if err != nil {

		fmt.Println(err)
	}

	fmt.Println("sig_res:", sig_res)
}

func TestRsaConfirmWithSha1Hex2(t *testing.T) {
	priv_key := "30820276020100300d06092a864886f70d0101010500048202603082025c02010002818100e6dbc6b5dae086198b601ba15db63d0a52068771b53ea0c4e188d5308135c57ce967ff7249ee8d3002016f01fcc2aeb5d54d1078570d651f01533e160437017192c87c4df1581d574d81a5edcec9eab40291df3e0a2516bae76f6a624a4bfb1ab93b0d6c545f3ad910d609ca736110e60e9965687f4ad7a3596314f349122df90203010001028180629ff5ae6f498840957883955691aa562460c1b0643bd337091b09e8e4ea71ea4154ba9ebad2fce24b990d318e2825b76cdeb57093d017293dc9b0367baa7c24971d6f22a8b9f7943f4059846c98335d26a51dbcc368c837cc6f7b145b979ed01af8440e94c4b860953e21157385a74dfffcbbf96f6b50d83567a2c40fa97e99024100feb86feee59446e0a04280c508f0a4eeb8249520347ac1527c377aebf1027a2c5ac833ad754b146b2cb39fbeb7cf7b780f7f2207cadaf6a828d3afb78349aff7024100e804a73993bdd63950f25527d6d4e6feb63ea7746069c3fbf3d8f052c18f568b58c20ad1f94a57a560a03e86cc7e0bad3d4eee1f42d97736a3757b2e412b758f02401f14e86bb14df79c1f521e1e6ce9d8665cc7f1fe7d08e1a02c122508b75f0303788c6769ea1f203db7b5af6f7944731f825c940d795e60acc2569a617d3eb79f024100e3c515a9476998b161ced45c2ce18af7484fcfb246a7edf71cd6be6e6f8858aca970ac909f4b2529bbe6f41aff0b4a4942a386ce77a0e710637d8474cf136bef02405cf74ffee8ea6d1fe777cab21060fa036521980c3741398ee602f82c0717d81bfaa02512a22698f4a094c81bdcdc19657bc8512435f61d4ea509ab75e76cac23"
	sessionId := "01172e29-f827-4f32-912c-015b70859c4e"
	operateId := "155"
	sigdata := "confirm," + sessionId + "," + operateId + "," + "4"

	fmt.Println("sigdata:", sigdata)
	sig_res, err := RsaSignWithSha1Hex(sigdata, priv_key)
	if err != nil {

		fmt.Println(err)
	}

	fmt.Println("sig_res:", sig_res)
}


func TestRsaRevokeWithSha1Hex2(t *testing.T) {
	priv_key := "30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100c7dce8900f6a00f06a631f95f3e2687ce85dbf042663697ef6f98e281e8e6a5f1e041d10be3a9832d70faf42402a749bc7233a0b4b50bda66024623ece59e653aa17c1ba5c4c0d777746135bef7b2fd68d1ce1f9b1ddc7a4efb8f648a15f2872f9e248eaf930c376c79db7e6a3270b541779239dafa04b0f28d0b2ea9a5cb6a70203010001028181008fe95b7450050e440ef6ed0976a13287ae71c25764a4f493bd96986bff04a147783f92063a53cabfe0e7a454da0b3807eb6e4c1f51ce03a1475d2b78f9f0f5cd46c72475748cb4200080cb1bd89734aaf610d764bb09de4e0d0339b8f8fafdc60fa45f2d7a6757d9adb1a6cac4753d0f855d45d34f7364ad7630d103dd2758c1024100e53e6f5d9f150a5bcf4af826f96b1ce7e57222e00708d7b95bfd383e06feac3297156cef14f6060fecb0a29e473569bc8b9dbc4c1119f251a18a9708513c6bb1024100df3099ef53200758b18903290cbe71c4e120dc202cc11e455478ecf19f824f9106456ad7f00d1d80dd511264f3cc0a17bbdfaecb3a2bec904a8383128044d5d7024100b9e5c4777e1e98d4d4a7adce252a883940e62a83d31087a74782734e516bca0608609682d6539f9ce04a68c4c367fc03aa9051f6b9537a1e5a4a41a9bbfeac3102406bf83eff9fdee6aee973b6abad1694430205bb77752f174dc2c79d186669cbc4049ca04b463d92003d10732d932329dec16c3c4ae4214b97a1f46cfc0e413e9102407d8f6e2262fc05ffe63fe7a0957d4a30b6be0b3d4c1842e7d9a51e86f8a4c1ced7999756aa4ff107f9680ee673ca42a23af9a40689de2c5da737332cbbb17c3d"
	sessionId := "cb865261-a990-4f43-8cec-aba0a01eeb92"
	operateId := "159"
	sigdata := "revoke," + sessionId + "," + operateId + "," + "5"

	fmt.Println("sigdata:", sigdata)
	sig_res, err := RsaSignWithSha1Hex(sigdata, priv_key)
	if err != nil {

		fmt.Println(err)
	}

	fmt.Println("sig_res:", sig_res)
}

func TestSignAndVerify(t *testing.T) {
	priv_key := "30820276020100300d06092a864886f70d0101010500048202603082025c02010002818100e6dbc6b5dae086198b601ba15db63d0a52068771b53ea0c4e188d5308135c57ce967ff7249ee8d3002016f01fcc2aeb5d54d1078570d651f01533e160437017192c87c4df1581d574d81a5edcec9eab40291df3e0a2516bae76f6a624a4bfb1ab93b0d6c545f3ad910d609ca736110e60e9965687f4ad7a3596314f349122df90203010001028180629ff5ae6f498840957883955691aa562460c1b0643bd337091b09e8e4ea71ea4154ba9ebad2fce24b990d318e2825b76cdeb57093d017293dc9b0367baa7c24971d6f22a8b9f7943f4059846c98335d26a51dbcc368c837cc6f7b145b979ed01af8440e94c4b860953e21157385a74dfffcbbf96f6b50d83567a2c40fa97e99024100feb86feee59446e0a04280c508f0a4eeb8249520347ac1527c377aebf1027a2c5ac833ad754b146b2cb39fbeb7cf7b780f7f2207cadaf6a828d3afb78349aff7024100e804a73993bdd63950f25527d6d4e6feb63ea7746069c3fbf3d8f052c18f568b58c20ad1f94a57a560a03e86cc7e0bad3d4eee1f42d97736a3757b2e412b758f02401f14e86bb14df79c1f521e1e6ce9d8665cc7f1fe7d08e1a02c122508b75f0303788c6769ea1f203db7b5af6f7944731f825c940d795e60acc2569a617d3eb79f024100e3c515a9476998b161ced45c2ce18af7484fcfb246a7edf71cd6be6e6f8858aca970ac909f4b2529bbe6f41aff0b4a4942a386ce77a0e710637d8474cf136bef02405cf74ffee8ea6d1fe777cab21060fa036521980c3741398ee602f82c0717d81bfaa02512a22698f4a094c81bdcdc19657bc8512435f61d4ea509ab75e76cac23"
	pub_key := "30819f300d06092a864886f70d010101050003818d0030818902818100e6dbc6b5dae086198b601ba15db63d0a52068771b53ea0c4e188d5308135c57ce967ff7249ee8d3002016f01fcc2aeb5d54d1078570d651f01533e160437017192c87c4df1581d574d81a5edcec9eab40291df3e0a2516bae76f6a624a4bfb1ab93b0d6c545f3ad910d609ca736110e60e9965687f4ad7a3596314f349122df90203010001"

	sigdata := "transfer,0d2c6510-0514-4fdf-a220-ad18f1dd0f5c,133,1,3ACW2eaZcaTSrcmuCBjJsQtQnBvXAF8uKT,1.01,0.001,,"

	sig_res, err := RsaSignWithSha1Hex(sigdata, priv_key)
	if err != nil {
		fmt.Println(err)
	}
	fmt.Println("sig_res:", sig_res)

	err = RsaVerySignWithSha1Hex(sigdata, sig_res, pub_key)
	if err != nil {
		fmt.Println(err)
	}
}